<project basedir=".">

  <!--
     - conf
    -->
  <target name="conf" depends="init, resin">
    <copy todir="${install}/conf" preservelastmodified="true">
      <fileset dir="conf">
      </fileset>
    </copy>
  </target>

  <!--
     - resin-files top
    -->
  <target name="resin-files" depends="init, resin-bin, resin-xml, app-default-xml"/>

  <target name="app-default-xml" depends="init">
    <!--
    <copy tofile="conf/app-default.xml"
          file="modules/resin/src/META-INF/caucho/app-default.xml"
          preservelastmodified="true"
          overwrite="true">
    </copy>
    -->
  </target>

  <!--
     - resin-xml
    -->
  <target name="resin-bin" depends="init">
    <copy tofile="bin/resin"
          file="bin/resin-dist.in"
          preservelastmodified="true">
      <filterset>
        <filter token="JAVA_EXE" value="java"/>
        <filter token="JAVA_ARGS" value=""/>
        <filter token="home_dir" value=""/>
        <filter token="root_dir" value=""/>
        <filter token="conf_dir" value=""/>
        <filter token="log_dir" value=""/>
      </filterset>
    </copy>
    
    <copy tofile="bin/baratine"
          file="bin/baratine-dist.in"
          preservelastmodified="true">
      <filterset>
        <filter token="JAVA_EXE" value="java"/>
        <filter token="JAVA_ARGS" value=""/>
        <filter token="home_dir" value=""/>
        <filter token="root_dir" value=""/>
        <filter token="conf_dir" value=""/>
        <filter token="log_dir" value=""/>
      </filterset>
    </copy>
    
    <chmod perm="ugo+rx">
      <fileset dir="${install}">
        <include name="bin/resin"/>
        <include name="bin/baratine"/>
      </fileset>
    </chmod>
  </target>

  <!--
     - resin-xml
    -->
  <target name="resin-xml" depends="init">
    <!--
    <copy tofile="conf/resin.properties"
          file="conf/resin.properties.in"
          preservelastmodified="true"
          overwrite="true">
      <filterset>
        <filter token="HTTP_PORT" value="${resin.http}"/>
        <filter token="HTTPS_PORT" value="${resin.https}"/>
        <filter token="SETUID_USER" value=""/>
        <filter token="SETUID_GROUP" value=""/>
      </filterset>
    </copy>
    -->
    
    <copy tofile="modules/resin/src/manifest"
          file="modules/resin/src/manifest.in"
          preservelastmodified="true"
          overwrite="true">
      <filterset>
        <filter token="VERSION" value="${version}"/>
      </filterset>
    </copy>
    
    <copy tofile="modules/resin/src/manifest.dist"
          file="modules/resin/src/manifest.dist.in"
          preservelastmodified="true"
          overwrite="true">
      <filterset>
        <filter token="VERSION" value="${version}"/>
      </filterset>
    </copy>
  </target>
  
</project>
